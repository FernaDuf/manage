{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <h2>Listado de Facturas</h2>

    <div class="mb-3">
        <a href="{{ url_for('facturas.mensual') }}" class="btn btn-success">🗓️ Facturación Mensual</a>
        <a href="{{ url_for('facturas.manual') }}" class="btn btn-info">➕ Factura Manual</a>
        <a href="{{ url_for('facturas.pago') }}" class="btn btn-warning">💰 Registrar Pago</a>
    </div>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th><th>Cliente</th><th>Plan</th><th>Monto</th><th>Fecha</th><th>Estado</th><th>Descripción</th>
            </tr>
        </thead>
        <tbody>
            {% for f in facturas %}
            <tr>
                <td>{{ f.id }}</td>
                <td>{{ f.numero_cliente }} - {{ f.cliente_nombre }}</td>
                <td>{{ f.plan_nombre or "-" }}</td>
                <td>${{ '%.2f' % (f.monto or 0) }}</td>
                <td>
                  {% set fecha = f.fecha if f.fecha is defined else (f.fecha_emision if f.fecha_emision is defined else None) %}
                  {% if fecha %}
                    {{ fecha.strftime("%d/%m/%Y") }}
                  {% else %}
                    -
                  {% endif %}
                </td>
                <td>{{ f.estado }}</td>
                <td>{{ f.descripcion or '' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
